<template id="page_template">
    <div class="mt-3">
        <div class="row">
            <div class="col-12 mb-5 mx-auto" style="max-width: 720px" v-for="(items, handler) in groupedAssets">
                <div
                    :is="handler"
                    :assets="items"
                    :app="app"
                    :manager="manager"
                    :address="address"
                    :web3="web3"
                    :time="time"
                    :key="handler"
                    ref="group"
                ></div>
            </div>
            <div class="col-12 mx-auto" style="max-width: 720px">
                <div v-if="manager.web3.faucet.address" class="card">
                    <div class="card-body">
                        <h4>Faucet</h4>
                        <p>To get some tokens to play with, use the faucet. These are all worthless, just for testing.</p>
                        <button class="btn btn-primary mb-3" @click="drip">Get test tokens</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<script>
    app.page = {
        props: ["manager", "web3", "address", "assets", "time"],
        data: function () {
            return {
            };
        },
        computed: {
            groupedAssets: function () {
                const groups = {};
                this.assets.forEach(asset => {
                    (groups[asset.handler] = groups[asset.handler] || []).push(asset);
                })
                return groups;
            },
        },
        methods: {
            drip: async function () {
                await this.web3.faucet.drip().send({ from: this.address })
            },
        },
    };
    page_done();
</script>
